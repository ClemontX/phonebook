<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <!-- Deactivate Compatibility Mode in IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Phonebook</title>
    <script>
      window.ENV = {
        environment: '${ENVIRONMENT}',
        environmentTag: '${ENVIRONMENT_TAG}',
        ravenURL: '${RAVEN_URL}',
        employeePicturesEndpoint: '${EMPLOYEE_PICTURES_ENDPOINT}',
        oldEmployeePictureEndpoint: '${OLD_EMPLOYEE_PICTURE_ENDPOINT}',
        assetsEndpoint: '${ASSETS_ENDPOINT}',
        contactEmail: '${CONTACT_EMAIL}',
        roomPlanningToolUrl: '${ROOMPLANNINGTOOL_URL}',
        contactUrl: '${CONTACT_URL}',
        rocketChatUrl: '${ROCKETCHAT_URL}'
      };
    </script>
    <base href="/" />
    <!-- Opensearch Compatibility https://stackoverflow.com/questions/7630144/how-to-add-google-chrome-omnibox-search-support-for-your-site -->
    <link rel="search" type="application/opensearchdescription+xml" title="Phonebook Search" href="/opensearch.xml" />

    <link rel="manifest" href="manifest.webmanifest" />
    <meta name="theme-color" content="#1976d2" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" type="image/x-icon" href="favicon.ico" />
  </head>
  <body class="mat-typography">
    <app-root></app-root>
    <noscript>Please enable JavaScript to continue using this application.</noscript>
  </body>

  <!-- Anti Clickjacking Script -->
  <!-- From: http://seclab.stanford.edu/websec/framebusting/framebust.pdf-->
  <style>
    body {
      display: none;
    }
  </style>
  <script>
    if (self == top) {
      document.getElementsByTagName('body')[0].style.display = 'flex';
    } else {
      top.location = self.location;
    }
    msieversion();

    function openURL(e) {
      browser = e.getAttribute('value');
      if (browser == 'microsoft-edge') {
        //edge can not be opened via shell
        window.open((browser = e.getAttribute('value') + ':' + window.location.href));
      } else {
        new ActiveXObject('WScript.Shell').run(browser + ' ' + window.location.href);
      }
    }

    function msieversion() {
      var browserList = {
        //list of browser-links where app can be openend in: key=browser name, value=shell-command to open browser
        'Microsoft Edge': 'microsoft-edge',
        'Google Chrome': 'chrome',
        'Mozilla Firefox': 'firefox',
        Opera: 'opera'
      };
      var ua = window.navigator.userAgent;
      var msie = ua.indexOf('MSIE ');

      if (msie > 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./)) {
        // stone age browser IE
        var html =
          '<div class="pb-no-ie"><p><strong>This application does not support Internet Explorer!</strong></p><p>To run the Phonebook, please use one of the following modern browsers:</p><ul>';
        for (var key in browserList) {
          html += '<li onclick="openURL(this)" value="' + browserList[key] + '"><strong>' + key + '</strong></li>';
        }
        html += '</ul><p>If this was detected by mistake consider <a href="https://github.com/T-Systems-MMS/phonebook/issues/new/choose">opening an issue</a>.</p> </div>';

        document.getElementsByTagName('body')[0].innerHTML = html;
      }
    }
  </script>
</html>
